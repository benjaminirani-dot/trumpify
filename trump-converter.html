<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Trump Transform by Ben</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
  <style>
    .glass {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.25);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    .mono { font-family: 'Courier New', monospace; }
    .orbitron { font-family: 'Orbitron', sans-serif; }
    .file-input::-webkit-file-upload-button { display: none; }
    .file-input::file-selector-button {
      @apply bg-white/20 border border-white/40 text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-white/30 transition;
    }
    .spinner {
      border: 4px solid rgba(255,255,255,0.3);
      border-left: 4px solid white;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .trump-overlay {
      mask-image: radial-gradient(circle at center, black 60%, transparent 80%);
      -webkit-mask-image: radial-gradient(circle at center, black 60%, transparent 80%);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-red-800 via-orange-700 to-yellow-600 text-white min-h-screen p-4 sm:p-6">
  <div class="max-w-3xl mx-auto">
    <header class="text-center mb-8">
      <h1 class="text-5xl sm:text-6xl font-bold orbitron bg-clip-text text-transparent bg-gradient-to-r from-yellow-400 to-red-600 drop-shadow-lg">
        TRUMP TRANSFORM
      </h1>
      <p class="mt-2 text-lg sm:text-xl opacity-90">Upload Your Photo → Become <span class="font-bold text-yellow-300">TRUMP</span>!</p>
      <p class="text-sm opacity-75 mt-1">by <strong>Ben</strong> • Free • Instant • No AI</p>
    </header>

    <main class="space-y-6">
      <!-- Upload Section -->
      <div class="glass p-6 rounded-2xl text-center">
        <label class="block text-sm font-bold mb-3">Upload Your Photo</label>
        <input
          type="file"
          id="fileInput"
          accept="image/*"
          class="file-input w-full p-4 rounded-xl bg-white/10 border border-white/30 text-white file:mr-4 file-input::file-selector-button"
        />
        <p class="text-xs mt-3 opacity-70">JPG, PNG, WebP • Max 10MB</p>
      </div>

      <!-- Live Preview of Uploaded Image -->
      <div id="userPreview" class="glass p-6 rounded-2xl hidden">
        <h3 class="font-bold mb-3 text-center text-yellow-300">Your Photo</h3>
        <img id="userImg" class="w-full max-h-64 object-contain mx-auto rounded-lg" alt="Your uploaded photo" />
      </div>

      <!-- Transform Button -->
      <button
        id="genTrump"
        class="w-full py-5 bg-gradient-to-r from-blue-700 to-blue-900 text-white rounded-2xl font-bold text-xl hover:from-blue-600 hover:to-blue-800 transform hover:scale-105 transition duration-200 shadow-xl disabled:opacity-50 disabled:cursor-not-allowed"
        disabled
      >
        <span id="btnText">Transform into Trump!</span>
        <div id="spinner" class="spinner hidden"></div>
      </button>

      <!-- Result Preview -->
      <div id="preview" class="glass p-6 rounded-2xl hidden">
        <h3 class="font-bold mb-4 text-center text-2xl text-yellow-300">TRUMP MODE ACTIVATED</h3>
        <div class="relative">
          <img id="trumpImg" class="w-full max-h-96 mx-auto rounded-xl shadow-2xl" alt="Trump transformation" />
          <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
            <p class="text-4xl font-bold orbitron text-yellow-400 drop-shadow-2xl opacity-80">TRUMP</p>
          </div>
        </div>
        <a
          id="download"
          class="mt-6 w-full text-center py-3 bg-gradient-to-r from-green-600 to-emerald-700 text-white rounded-xl block font-bold hover:from-green-500 hover:to-emerald-600 transition shadow-lg"
          download="trump-me.png"
        >
          Download Trump Me
        </a>
      </div>

      <!-- Log Console -->
      <div id="log" class="glass p-4 h-32 overflow-y-auto mono text-xs bg-black/40 rounded-xl text-center opacity-80"></div>
    </main>

    <footer class="text-center mt-12 text-xs opacity-60">
      © 2025 Ben • 100% Free • Client-Side Only • No Data Sent
    </footer>
  </div>

  <script>
    const $ = id => document.getElementById(id);
    const log = msg => {
      const time = new Date().toLocaleTimeString('en-US', { hour12: false });
      $('log').innerHTML += `<div class="mb-1">[${time}] ${msg}</div>`;
      $('log').scrollTop = $('log').scrollHeight;
    };

    // Trump face overlay (transparent PNG with face cutout)
    const TRUMP_OVERLAY = 'https://i.imgur.com/8y3N5fS.png'; // Must be CORS-friendly

    const fileInput = $('fileInput');
    const genTrump = $('genTrump');
    const userPreview = $('userPreview');
    const userImg = $('userImg');
    const preview = $('preview');
    const trumpImg = $('trumpImg');
    const download = $('download');
    const btnText = $('btnText');
    const spinner = $('spinner');

    let userFile = null;

    // Enable button when file is selected
    fileInput.addEventListener('change', () => {
      userFile = fileInput.files[0];
      if (!userFile) return;

      if (userFile.size > 10 * 1024 * 1024) {
        alert('Image too large! Please use under 10MB.');
        return;
      }

      genTrump.disabled = false;
      userPreview.classList.remove('hidden');
      userImg.src = URL.createObjectURL(userFile);
      log('Photo uploaded. Ready to transform!');
    });

    // Main transform function
    genTrump.addEventListener('click', async () => {
      if (!userFile) return;

      // UI: Show loading
      btnText.classList.add('hidden');
      spinner.classList.remove('hidden');
      genTrump.disabled = true;
      preview.classList.add('hidden');
      log('Starting Trump transformation...');

      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      canvas.width = 600;
      canvas.height = 600;

      try {
        // Load user image
        const img = await loadImage(URL.createObjectURL(userFile));
        const trumpOverlay = await loadImage(TRUMP_OVERLAY);

        // Draw user image (fit to canvas)
        drawFittedImage(ctx, img, canvas.width, canvas.height);

        // Apply Trump overlay with soft mask
        ctx.globalAlpha = 0.78;
        ctx.drawImage(trumpOverlay, 0, 0, canvas.width, canvas.height);
        ctx.globalAlpha = 1.0;

        // Add "TRUMP MODE" badge
        ctx.font = 'bold 48px Orbitron, Arial';
        ctx.fillStyle = '#FFD700';
        ctx.strokeStyle = '#000';
        ctx.lineWidth = 6;
        ctx.textAlign = 'center';
        ctx.strokeText('TRUMP MODE', canvas.width / 2, 560);
        ctx.fillText('TRUMP MODE', canvas.width / 2, 560);

        // Output result
        const resultUrl = canvas.toDataURL('image/png');
        trumpImg.src = resultUrl;
        download.href = resultUrl;
        download.download = `trump-me-${Date.now()}.png`;

        // Show result
        preview.classList.remove('hidden');
        log('Transformation complete! Download ready.');

      } catch (err) {
        log(`Error: ${err.message}`);
        alert('Transformation failed. Try a clearer face photo.');
      } finally {
        // Reset button
        btnText.classList.remove('hidden');
        spinner.classList.add('hidden');
        genTrump.disabled = false;
      }
    });

    // Helper: Load image with Promise
    function loadImage(src) {
      return new Promise((resolve, reject) => {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        img.onload = () => resolve(img);
        img.onerror = () => reject(new Error('Failed to load image'));
        img.src = src;
      });
    }

    // Helper: Draw image fitted to canvas (cover)
    function drawFittedImage(ctx, img, width, height) {
      const scale = Math.max(width / img.width, height / img.height);
      const w = img.width * scale;
      const h = img.height * scale;
      const x = (width - w) / 2;
      const y = (height - h) / 2;
      ctx.drawImage(img, x, y, w, h);
    }

    // Init
    window.onload = () => {
      log('App loaded. Upload a photo to begin.');
    };
  </script>
</body>
</html>
